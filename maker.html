<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìœ íŠœë¸Œ ì¸ë„¤ì¼ ë³€í™˜ê¸° (OG Maker)</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background: #f0f0f0; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h2 { color: #333; }
        
        /* ì—…ë¡œë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .file-upload { margin: 20px 0; }
        input[type=file] { display: none; }
        .custom-upload {
            background-color: #fee500; color: #3c1e1e; 
            padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;
        }
        
        /* ìº”ë²„ìŠ¤ (ë¯¸ë¦¬ë³´ê¸°) */
        canvas { 
            max-width: 100%; height: auto; 
            border: 1px solid #ddd; margin-top: 20px; 
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        /* ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ */
        #downloadBtn {
            display: none; margin-top: 20px;
            background-color: #333; color: white;
            padding: 12px 24px; text-decoration: none; border-radius: 5px; font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“¸ ì¹´í†¡ ê³µìœ ìš© ì´ë¯¸ì§€ ë³€í™˜ê¸°</h2>
    <p>ì„¸ë¡œ ì´ë¯¸ì§€ë¥¼ ì˜¬ë¦¬ë©´ ê°€ë¡œí˜•(1200x630)ìœ¼ë¡œ ìë™ ë³€í™˜ë©ë‹ˆë‹¤.</p>

    <div class="file-upload">
        <label for="imgInput" class="custom-upload">ğŸ“‚ ì´ë¯¸ì§€ ì—…ë¡œë“œí•˜ê¸°</label>
        <input type="file" id="imgInput" accept="image/*">
    </div>

    <canvas id="canvas" width="1200" height="630"></canvas>
    <br>
    <a id="downloadBtn" download="og_image.jpg">ğŸ’¾ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</a>
</div>

<script>
    const imgInput = document.getElementById('imgInput');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const downloadBtn = document.getElementById('downloadBtn');

    imgInput.addEventListener('change', function(e) {
        if(e.target.files && e.target.files[0]) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    drawCanvas(img);
                }
                img.src = event.target.result;
            }
            reader.readAsDataURL(e.target.files[0]);
        }
    });

    function drawCanvas(img) {
        // 1. ë°°ê²½ ì±„ìš°ê¸° (ë¸”ëŸ¬ íš¨ê³¼ í‰ë‚´ - ì´ë¯¸ì§€ë¥¼ í™•ëŒ€í•´ì„œ ê·¸ë¦¼)
        // ìº”ë²„ìŠ¤ í¬ê¸°
        const cw = canvas.width;
        const ch = canvas.height;
        
        // ë°°ê²½: ì´ë¯¸ì§€ë¥¼ ìº”ë²„ìŠ¤ ë„ˆë¹„ì— ë§ì¶° ê½‰ ì°¨ê²Œ ê·¸ë¦¼ (ë¹„ìœ¨ ìœ ì§€í•˜ë©° í¬ë¡­ë¨)
        const scaleBg = Math.max(cw / img.width, ch / img.height);
        const bgWidth = img.width * scaleBg;
        const bgHeight = img.height * scaleBg;
        const bgX = (cw - bgWidth) / 2;
        const bgY = (ch - bgHeight) / 2;

        // ë¸”ëŸ¬ í•„í„° ì ìš© í›„ ë°°ê²½ ê·¸ë¦¬ê¸°
        ctx.filter = 'blur(20px) brightness(0.7)'; // íë¦¬ê²Œ + ì•½ê°„ ì–´ë‘¡ê²Œ
        ctx.drawImage(img, bgX, bgY, bgWidth, bgHeight);
        
        // í•„í„° í•´ì œ (ì¤‘ì•™ ì´ë¯¸ì§€ëŠ” ì„ ëª…í•´ì•¼ í•¨)
        ctx.filter = 'none';

        // 2. ì¤‘ì•™ì— ì›ë³¸ ì„¸ë¡œ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸° (í™”ë©´ ë†’ì´ì— ë§ì¶¤)
        const scaleFg = ch / img.height; // ë†’ì´ë¥¼ ìº”ë²„ìŠ¤ì— ë§ì¶¤
        // ë§Œì•½ ì´ë¯¸ì§€ê°€ ë„ˆë¬´ ëš±ëš±í•˜ë©´ ë„ˆë¹„ ê¸°ì¤€ìœ¼ë¡œ ë§ì¶¤ (ì•ˆì „ì¥ì¹˜)
        const scaleFinal = Math.min(scaleFg, (cw * 0.9) / img.width); 

        const fgWidth = img.width * scaleFinal;
        const fgHeight = img.height * scaleFinal;
        const fgX = (cw - fgWidth) / 2;
        const fgY = (ch - fgHeight) / 2;

        // ê·¸ë¦¼ì íš¨ê³¼ (ì¤‘ì•™ ì´ë¯¸ì§€ ê°•ì¡°)
        ctx.shadowColor = "rgba(0, 0, 0, 0.5)";
        ctx.shadowBlur = 20;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 0;

        ctx.drawImage(img, fgX, fgY, fgWidth, fgHeight);

        // 3. ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í™œì„±í™”
        downloadBtn.style.display = 'inline-block';
        
        // ìº”ë²„ìŠ¤ ë‚´ìš©ì„ ì´ë¯¸ì§€ URLë¡œ ë³€í™˜í•˜ì—¬ ë‹¤ìš´ë¡œë“œ ë§í¬ì— ì—°ê²°
        downloadBtn.href = canvas.toDataURL('image/jpeg', 0.9);
    }
</script>

</body>
</html>
