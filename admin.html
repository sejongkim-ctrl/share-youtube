<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ ì˜¬ì¸ì› ë§í¬ ë§ˆìŠ¤í„° (ë¶™ì—¬ë„£ê¸° ì§€ì›)</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; background: #f4f6f8; color: #333; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; }
        
        .input-section { flex: 1; min-width: 320px; background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .preview-section { flex: 1; min-width: 320px; background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); text-align: center; }

        h2 { margin-top: 0; color: #1a1a1a; font-size: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        label { display: block; margin-top: 15px; font-weight: 600; font-size: 14px; color: #555; }
        input[type="text"], input[type="file"] { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        input:focus { border-color: #007aff; outline: none; }
        
        /* íŒŒì¼ ì—…ë¡œë“œ ë°•ìŠ¤ ë””ìì¸ (ê°•ì¡°ë¨) */
        .file-box { 
            background: #f0f7ff; padding: 20px; border-radius: 8px; 
            border: 2px dashed #007aff; text-align: center; margin-top: 5px; 
            cursor: pointer; color: #0056b3; transition: 0.2s;
        }
        .file-box:hover { background: #e0efff; }
        .file-box.active { background: #d4edda; border-color: #28a745; color: #155724; }

        .btn-action { width: 100%; padding: 15px; margin-top: 20px; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.2s; }
        .btn-blue { background: #007aff; color: white; }
        .btn-blue:hover { background: #0056b3; }
        
        .btn-green { background: #2dba4e; color: white; margin-top: 10px; } 
        .btn-dark { background: #333; color: white; margin-top: 5px; } 

        #resultArea { display: none; margin-top: 20px; padding-top: 20px; border-top: 2px dashed #eee; }
        canvas { max-width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 10px; }
        
        .code-box { background: #222; color: #81e6d9; padding: 10px; border-radius: 6px; font-family: monospace; font-size: 12px; text-align: left; height: 80px; overflow-y: scroll; margin-bottom: 10px; }
        
        /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ (ë³µì‚¬ ì•Œë¦¼) */
        #toast { visibility: hidden; min-width: 250px; margin-left: -125px; background-color: #333; color: #fff; text-align: center; border-radius: 2px; padding: 16px; position: fixed; z-index: 1; left: 50%; bottom: 30px; font-size: 17px; }
        #toast.show { visibility: visible; -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>

<div style="text-align: center; margin-bottom: 20px;">
    <h1>ğŸ‘‘ ì˜¬ì¸ì› ë§í¬ ë§ˆìŠ¤í„° V3</h1>
    <p>í™”ë©´ ì•„ë¬´ ê³³ì´ë‚˜ í´ë¦­í•˜ê³  <strong>[Ctrl + V]</strong>ë¡œ ì´ë¯¸ì§€ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!</p>
</div>

<div class="container">
    <div class="input-section">
        <h2>ğŸ“ ì •ë³´ ì…ë ¥</h2>
        
        <label>1. ì„¸ë¡œí˜• ì´ë¯¸ì§€ (í´ë¦­ or ë¶™ì—¬ë„£ê¸°)</label>
        <div id="dropZone" class="file-box" onclick="document.getElementById('imgInput').click()">
            ğŸ“‹ <strong>Ctrl + V</strong> ë¡œ ë¶™ì—¬ë„£ê¸°<br>
            <span style="font-size:12px; font-weight:normal;">(ë˜ëŠ” í´ë¦­í•´ì„œ íŒŒì¼ ì„ íƒ)</span>
        </div>
        <input type="file" id="imgInput" accept="image/*" style="display: none;">

        <label>2. í´ë” ì´ë¦„ (ì˜ë¬¸/ìˆ«ì)</label>
        <input type="text" id="folderName" placeholder="ì˜ˆ: event1">
        
        <label>3. ìœ íŠœë¸Œ ì˜ìƒ ë§í¬</label>
        <input type="text" id="youtubeLink" placeholder="https://youtu.be/...">

        <label>4. ì œëª© (ì¹´í†¡ í° ê¸€ì”¨)</label>
        <input type="text" id="ogTitle" placeholder="ì˜ìƒ ì œëª© ì…ë ¥">

        <label>5. ì„¤ëª… (ì¹´í†¡ ì‘ì€ ê¸€ì”¨)</label>
        <input type="text" id="ogDesc" placeholder="ì˜ìƒ ì„¤ëª… ì…ë ¥">

        <button class="btn-action btn-blue" onclick="processAll()">âš¡ ë³€í™˜ ë° ì½”ë“œ ìƒì„±</button>
    </div>

    <div class="preview-section">
        <h2>ğŸ‘€ ë¯¸ë¦¬ë³´ê¸° & ë‹¤ìš´ë¡œë“œ</h2>
        <canvas id="canvas" width="1200" height="630"></canvas>
        <p id="waitMsg" style="color:#999; margin-top:20px;">ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.<br>ìº¡ì³ í›„ <strong>Ctrl+V</strong> í•˜ì„¸ìš”!</p>

        <div id="resultArea">
            <a id="downloadLink" class="btn-action btn-dark" style="display:block; text-decoration:none; line-height: 20px;">
                ğŸ’¾ 1. ë³€í™˜ëœ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
            </a>

            <div style="margin-top: 20px; text-align: left;">
                <label>ğŸ“‹ 2. ìƒì„±ëœ ì½”ë“œ (ìë™ ë³µì‚¬ë¨)</label>
                <div id="codeDisplay" class="code-box"></div>
            </div>

            <button class="btn-action btn-green" onclick="goToGithub()">
                ğŸš€ 3. ê¹ƒí—ˆë¸Œ ê°€ì„œ ë¶™ì—¬ë„£ê¸°
            </button>
        </div>
    </div>
</div>

<div id="toast">ì´ë¯¸ì§€ê°€ ë¶™ì—¬ë„£ê¸° ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“¸</div>

<script>
    const imgInput = document.getElementById('imgInput');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const dropZone = document.getElementById('dropZone');
    let isImageReady = false;

    // [í•µì‹¬] ë¶™ì—¬ë„£ê¸°(Paste) ì´ë²¤íŠ¸ ê°ì§€
    document.addEventListener('paste', function(e) {
        const items = (e.clipboardData || e.originalEvent.clipboardData).items;
        
        for (let index in items) {
            const item = items[index];
            if (item.kind === 'file' && item.type.indexOf('image/') !== -1) {
                const blob = item.getAsFile();
                handleImageFile(blob); // ì´ë¯¸ì§€ ì²˜ë¦¬ í•¨ìˆ˜ í˜¸ì¶œ
                showToast("ì´ë¯¸ì§€ê°€ ë¶™ì—¬ë„£ê¸° ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“¸");
                break; // ì´ë¯¸ì§€ê°€ ì—¬ëŸ¬ ê°œë¼ë„ ì²« ë²ˆì§¸ë§Œ ì²˜ë¦¬
            }
        }
    });

    // íŒŒì¼ ì„ íƒ(í´ë¦­) ì‹œ ì²˜ë¦¬
    imgInput.addEventListener('change', function(e) {
        if(e.target.files && e.target.files[0]) {
            handleImageFile(e.target.files[0]);
        }
    });

    // ê³µí†µ ì´ë¯¸ì§€ ì²˜ë¦¬ ë¡œì§
    function handleImageFile(file) {
        const reader = new FileReader();
        reader.onload = function(event) {
            const img = new Image();
            img.onload = function() {
                drawCanvas(img);
                isImageReady = true;
                // UI ì—…ë°ì´íŠ¸
                dropZone.innerHTML = "âœ… <strong>ì´ë¯¸ì§€ ë“±ë¡ ì™„ë£Œ!</strong><br><span style='font-size:12px'>ë‹¤ë¥¸ ì´ë¯¸ì§€ë¥¼ ë¶™ì—¬ë„£ìœ¼ë ¤ë©´ ë‹¤ì‹œ Ctrl+V í•˜ì„¸ìš”</span>";
                dropZone.classList.add('active');
            }
            img.src = event.target.result;
        }
        reader.readAsDataURL(file);
    }

    function drawCanvas(img) {
        const cw = canvas.width; const ch = canvas.height;
        
        // ë°°ê²½ ë¸”ëŸ¬
        const scaleBg = Math.max(cw / img.width, ch / img.height);
        const bgW = img.width * scaleBg; const bgH = img.height * scaleBg;
        ctx.filter = 'blur(20px) brightness(0.7)';
        ctx.drawImage(img, (cw - bgW) / 2, (ch - bgH) / 2, bgW, bgH);
        
        // ì¤‘ì•™ ì´ë¯¸ì§€
        ctx.filter = 'none';
        const scaleFg = Math.min(ch / img.height, (cw * 0.9) / img.width);
        const fgW = img.width * scaleFg; const fgH = img.height * scaleFg;
        
        ctx.shadowColor = "rgba(0,0,0,0.5)"; ctx.shadowBlur = 20;
        ctx.drawImage(img, (cw - fgW) / 2, (ch - fgH) / 2, fgW, fgH);
        
        document.getElementById('waitMsg').style.display = 'none';
    }

    function processAll() {
        const folder = document.getElementById('folderName').value.trim();
        const youtube = document.getElementById('youtubeLink').value.trim();
        const title = document.getElementById('ogTitle').value.trim();
        const desc = document.getElementById('ogDesc').value.trim();

        if(!isImageReady) { alert('ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤! í™”ë©´ì„ í´ë¦­í•˜ê³  Ctrl+V í•˜ì„¸ìš”.'); return; }
        if(!folder || !youtube) { alert('í´ë” ì´ë¦„ê³¼ ìœ íŠœë¸Œ ë§í¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!'); return; }

        // ë‹¤ìš´ë¡œë“œ ì„¤ì •
        const dataURL = canvas.toDataURL('image/jpeg', 0.9);
        const downloadBtn = document.getElementById('downloadLink');
        downloadBtn.href = dataURL;
        downloadBtn.download = 'og_image.jpg';

        // ì½”ë“œ ìƒì„±
        const htmlCode = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:type" content="website">
    <meta property="og:title" content="${title}">
    <meta property="og:description" content="${desc}">
    <meta property="og:image" content="./og_image.jpg">
    <meta http-equiv="refresh" content="0; url=${youtube}">
    <title>Redirecting...</title>
    <script type="text/javascript">window.location.href = "${youtube}";<\/script>
</head>
<body><p>ì´ë™ ì¤‘...</p></body>
</html>`;

        document.getElementById('codeDisplay').innerText = htmlCode;
        navigator.clipboard.writeText(htmlCode);
        document.getElementById('resultArea').style.display = 'block';
        
        alert('ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ë²„íŠ¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    function goToGithub() {
        const folder = document.getElementById('folderName').value.trim();
        const repoPath = window.location.pathname.split('/')[1]; 
        const user = window.location.hostname.split('.')[0];
        const targetUrl = `https://github.com/${user}/${repoPath}/new/main/?filename=${folder}/index.html`;
        window.open(targetUrl, '_blank');
    }

    function showToast(msg) {
        var x = document.getElementById("toast");
        x.className = "show";
        x.innerText = msg;
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }
</script>

</body>
</html>
