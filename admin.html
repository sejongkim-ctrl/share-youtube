<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ ì˜¬ì¸ì› ë§í¬ ë§ˆìŠ¤í„°</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f4f6f8; color: #333; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; }
        
        /* ì™¼ìª½: ì…ë ¥ í¼ */
        .input-section { flex: 1; min-width: 300px; background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        
        /* ì˜¤ë¥¸ìª½: ë¯¸ë¦¬ë³´ê¸° ë° ê²°ê³¼ */
        .preview-section { flex: 1; min-width: 300px; background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); text-align: center; }

        h2 { margin-top: 0; color: #1a1a1a; font-size: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        label { display: block; margin-top: 15px; font-weight: 600; font-size: 14px; color: #555; }
        input[type="text"], input[type="file"] { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        input:focus { border-color: #007aff; outline: none; }
        
        /* íŒŒì¼ ì—…ë¡œë“œ ë””ìì¸ */
        .file-box { background: #f9f9f9; padding: 15px; border-radius: 8px; border: 2px dashed #ddd; text-align: center; margin-top: 5px; cursor: pointer; }
        .file-box:hover { border-color: #007aff; background: #eef7ff; }

        /* ë²„íŠ¼ */
        .btn-action { width: 100%; padding: 15px; margin-top: 20px; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.2s; }
        .btn-blue { background: #007aff; color: white; } /* ìƒì„± ë²„íŠ¼ */
        .btn-blue:hover { background: #0056b3; }
        
        .btn-green { background: #2dba4e; color: white; margin-top: 10px; } /* ê¹ƒí—ˆë¸Œ ë²„íŠ¼ */
        .btn-dark { background: #333; color: white; margin-top: 5px; } /* ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ */

        /* ê²°ê³¼ ì˜ì—­ */
        #resultArea { display: none; margin-top: 20px; padding-top: 20px; border-top: 2px dashed #eee; }
        canvas { max-width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 10px; }
        
        .code-box { background: #222; color: #81e6d9; padding: 10px; border-radius: 6px; font-family: monospace; font-size: 12px; text-align: left; height: 80px; overflow-y: scroll; margin-bottom: 10px; }
    </style>
</head>
<body>

<div style="text-align: center; margin-bottom: 20px;">
    <h1>ğŸ‘‘ ì˜¬ì¸ì› ë§í¬ ë§ˆìŠ¤í„°</h1>
    <p>ì´ë¯¸ì§€ ë³€í™˜ë¶€í„° ì½”ë“œ ìƒì„±ê¹Œì§€ í•œ ë²ˆì— ì²˜ë¦¬í•˜ì„¸ìš”.</p>
</div>

<div class="container">
    <div class="input-section">
        <h2>ğŸ“ ì •ë³´ ì…ë ¥</h2>
        
        <label>1. ì„¸ë¡œí˜• ì´ë¯¸ì§€ ì—…ë¡œë“œ</label>
        <div class="file-box" onclick="document.getElementById('imgInput').click()">
            ğŸ“‚ í´ë¦­í•´ì„œ ì´ë¯¸ì§€ ì„ íƒ (ì„¸ë¡œí˜•)
        </div>
        <input type="file" id="imgInput" accept="image/*" style="display: none;">

        <label>2. í´ë” ì´ë¦„ (ì˜ë¬¸/ìˆ«ì)</label>
        <input type="text" id="folderName" placeholder="ì˜ˆ: event1">
        <p style="font-size:12px; color:#888;">* ì´ ì´ë¦„ì´ ë§í¬ ì£¼ì†Œê°€ ë©ë‹ˆë‹¤.</p>

        <label>3. ìœ íŠœë¸Œ ì˜ìƒ ë§í¬</label>
        <input type="text" id="youtubeLink" placeholder="https://youtu.be/...">

        <label>4. ì œëª© (ì¹´í†¡ í° ê¸€ì”¨)</label>
        <input type="text" id="ogTitle" placeholder="ì˜ìƒ ì œëª© ì…ë ¥">

        <label>5. ì„¤ëª… (ì¹´í†¡ ì‘ì€ ê¸€ì”¨)</label>
        <input type="text" id="ogDesc" placeholder="ì˜ìƒ ì„¤ëª… ì…ë ¥">

        <button class="btn-action btn-blue" onclick="processAll()">âš¡ ë³€í™˜ ë° ì½”ë“œ ìƒì„±</button>
    </div>

    <div class="preview-section">
        <h2>ğŸ‘€ ë¯¸ë¦¬ë³´ê¸° & ë‹¤ìš´ë¡œë“œ</h2>
        
        <canvas id="canvas" width="1200" height="630"></canvas>
        <p id="waitMsg" style="color:#999;">ì™¼ìª½ì—ì„œ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³ <br>ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>

        <div id="resultArea">
            <a id="downloadLink" class="btn-action btn-dark" style="display:block; text-decoration:none; line-height: 20px;">
                ğŸ’¾ 1. ë³€í™˜ëœ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
            </a>

            <div style="margin-top: 20px; text-align: left;">
                <label>ğŸ“‹ 2. ìƒì„±ëœ ì½”ë“œ (ìë™ ë³µì‚¬ë¨)</label>
                <div id="codeDisplay" class="code-box"></div>
            </div>

            <button class="btn-action btn-green" onclick="goToGithub()">
                ğŸš€ 3. ê¹ƒí—ˆë¸Œ ê°€ì„œ ë¶™ì—¬ë„£ê¸°
            </button>
            
            <p style="font-size:12px; color:#666; margin-top:10px;">
                * ê¹ƒí—ˆë¸Œì—ì„œ <strong>[Ctrl+V]</strong>ë¡œ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ê³ ,<br>
                ë°©ê¸ˆ ë‹¤ìš´ë¡œë“œí•œ <strong>ì´ë¯¸ì§€ë„ ê°™ì´ ì—…ë¡œë“œ</strong> í•´ì£¼ì„¸ìš”.
            </p>
        </div>
    </div>
</div>

<script>
    const imgInput = document.getElementById('imgInput');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let isImageReady = false;

    // ì´ë¯¸ì§€ ì„ íƒ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì²˜ë¦¬
    imgInput.addEventListener('change', function(e) {
        if(e.target.files && e.target.files[0]) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    drawCanvas(img);
                    isImageReady = true;
                    document.querySelector('.file-box').innerText = "âœ… " + e.target.files[0].name;
                }
                img.src = event.target.result;
            }
            reader.readAsDataURL(e.target.files[0]);
        }
    });

    function drawCanvas(img) {
        // ë°°ê²½ ë¸”ëŸ¬ ì²˜ë¦¬ ë° í•©ì„± ë¡œì§
        const cw = canvas.width; const ch = canvas.height;
        const scaleBg = Math.max(cw / img.width, ch / img.height);
        const bgW = img.width * scaleBg; const bgH = img.height * scaleBg;
        
        ctx.filter = 'blur(20px) brightness(0.7)';
        ctx.drawImage(img, (cw - bgW) / 2, (ch - bgH) / 2, bgW, bgH);
        
        ctx.filter = 'none';
        const scaleFg = Math.min(ch / img.height, (cw * 0.9) / img.width);
        const fgW = img.width * scaleFg; const fgH = img.height * scaleFg;
        
        ctx.shadowColor = "rgba(0,0,0,0.5)"; ctx.shadowBlur = 20;
        ctx.drawImage(img, (cw - fgW) / 2, (ch - fgH) / 2, fgW, fgH);
        
        document.getElementById('waitMsg').style.display = 'none';
    }

    function processAll() {
        const folder = document.getElementById('folderName').value.trim();
        const youtube = document.getElementById('youtubeLink').value.trim();
        const title = document.getElementById('ogTitle').value.trim();
        const desc = document.getElementById('ogDesc').value.trim();

        if(!isImageReady) { alert('ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”!'); return; }
        if(!folder || !youtube) { alert('í´ë” ì´ë¦„ê³¼ ìœ íŠœë¸Œ ë§í¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!'); return; }

        // 1. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
        const dataURL = canvas.toDataURL('image/jpeg', 0.9);
        const downloadBtn = document.getElementById('downloadLink');
        downloadBtn.href = dataURL;
        downloadBtn.download = 'og_image.jpg'; // íŒŒì¼ëª… ê³ ì •

        // 2. HTML ì½”ë“œ ìƒì„±
        const htmlCode = `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:type" content="website">
    <meta property="og:title" content="${title}">
    <meta property="og:description" content="${desc}">
    <meta property="og:image" content="./og_image.jpg">
    <meta http-equiv="refresh" content="0; url=${youtube}">
    <title>Redirecting...</title>
    <script type="text/javascript">window.location.href = "${youtube}";<\/script>
</head>
<body><p>ì´ë™ ì¤‘...</p></body>
</html>`;

        document.getElementById('codeDisplay').innerText = htmlCode;
        
        // 3. í´ë¦½ë³´ë“œ ë³µì‚¬
        navigator.clipboard.writeText(htmlCode);
        
        // 4. ê²°ê³¼ì°½ í‘œì‹œ
        document.getElementById('resultArea').style.display = 'block';
        alert('ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n1. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í´ë¦­\n2. ê¹ƒí—ˆë¸Œë¡œ ì´ë™ ë²„íŠ¼ í´ë¦­');
    }

    function goToGithub() {
        const folder = document.getElementById('folderName').value.trim();
        const repoPath = window.location.pathname.split('/')[1]; 
        const user = window.location.hostname.split('.')[0];
        const targetUrl = `https://github.com/${user}/${repoPath}/new/main/?filename=${folder}/index.html`;
        window.open(targetUrl, '_blank');
    }
</script>

</body>
</html>
